print =: [: stdout ,&LF

NB. –≠–Ω—Ç—Ä–æ–ø–∏—è —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ / –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏
I =: [: -@(+/) (*2&^.)"0

NB. –°–æ–∑–¥–∞—ë—Ç –º–∞—Å—Å–∏–≤ —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π, —Å—É–º–º–∞ –∫–æ—Ç–æ—Ä—ã—Ö –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–Ω–∞ 1.0
Px =: [: (%+/)@:? $&0
NB. –°–æ–∑–¥–∞—ë—Ç –º–∞—Å—Å–∏–≤ N —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–ª–∏–Ω —Å–æ–æ–±—â–µ–Ω–∏–π (0, N] –º–∫—Å
ti =: * ] ?@$ 0:

NB. –ú–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, –≥–¥–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ–π –æ—à–∏–±–∫–∏
NB. –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ q, –≥–¥–µ q = 1/(2√óN). –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π N
PY_Z =: %@+: (] (] + [ * [: -. +/"1@]) [ * ?@]) =@:i.

NB. Py –≤—ã—á–∏—Å–ª—è–µ—Ç –º–∞—Å—Å–∏–≤ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏
NB. –º–∞—Ç—Ä–∏—Ü—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (—Ç.–µ. Px u PY_Z)
NB. tbar –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω—é—é –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤
NB. –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –≤—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –¥–ª–∏–Ω (—Ç.–µ. Px u ti)
tbar=:Py=: +/ .*

NB. –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
NB. –≤—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –¥–ª–∏–Ω (—Ç.–µ. Px u ti)
C=: 2&^.@:#@] % tbar

NB. –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Å –ø–æ–º–µ—Ö–∞–º–∏, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
NB. –≤—Ö–æ–¥–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –¥–ª–∏–Ω, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (—Ç.–µ. Px (HX_Y)u ti)
C_faulty=: adverb : 0
    (x C y) - u % x tbar y
)

NB. –í—ã—á–∏—Å–ª—è–µ—Ç –º–∞—Ç—Ä–∏—Ü—É —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –≤—ã—Ö–æ–¥–Ω—ã—Ö
NB. —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –º–∞—Ç—Ä–∏—Ü—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (—Ç.–µ. Py u PY_Z)
PXY=: *"1

NB. –í—ã—á–∏—Å–ª—è–µ—Ç —É—Å–ª–æ–≤–Ω—É—é —ç–Ω—Ç—Ä–æ–ø–∏—é. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Ç—Ä–∏—Ü—É —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –∏
NB. –º–∞—Ç—Ä–∏—Ü—É –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ (—Ç.–µ. PXY u PY_Z)
HX_Y=: [: -@(+/)@(+/) [ * 2 ^. ]

NB. –í—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–ª—É—á–∞–µ–º–æ–µ –ø—Ä–∏ –Ω–µ–ø–æ–ª–Ω–æ–π
NB. –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–π. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —É—Å–ª–æ–≤–Ω—É—é —ç–Ω—Ç—Ä–æ–ø–∏—é –∏ –º–∞—Å—Å–∏–≤ –≤—Ö–æ–¥–Ω—ã—Ö
NB. —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç.–µ. HX_Y u Px)
IXY=: -~I

NB. –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É –±–µ–∑ –ø–æ–º–µ—Ö. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç
NB. —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç.–µ. Px u ti)
IY=: I@:[ % tbar

NB. –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É —Å –ø–æ–º–µ—Ö–∞–º–∏. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç
NB. —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –º–∞—Å—Å–∏–≤ –¥–ª–∏–Ω —Å–æ–æ–±—â–µ–Ω–∏–π (—Ç.–µ. Px (IXY)u ti)
IZY=: adverb : 0
    u % x tbar y
)

NB. --------------

NB. –û–¥–Ω–æ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ
trial =: monad : 0
    print ''
    print '–ò—Å–ø—ã—Ç–∞–Ω–∏–µ ‚Ññ', ": y
    print ' –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã—Ö –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –≤—Ö–æ–¥–µ, P(X):'
    print '  ', 0j5": inputs =. Px amount
    print ' –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã—Ö –∏–∑ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –≤—Ö–æ–¥–µ, tûÅ®:'
    print '  ', 0j5": durations =. ti amount
    print ' –ú–∞—Ç—Ä–∏—Ü–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, P(Y/Z):'
    stdout ,LF,.~'  ',"(1) 0j5": transitions =. PY_Z amount

    outputs =. inputs Py transitions
    joint_provs =. outputs PXY transitions
    conditional =. joint_provs HX_Y transitions
    information =. conditional IXY inputs

    print ' –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É –±–µ–∑ –ø–æ–º–µ—Ö, I(Y): ',' –ö–±–∏—Ç/—Å',~ 0j5": 1000*speed=. inputs IY durations
    print ' –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –±–µ–∑ –ø–æ–º–µ—Ö, –°: ',' –ö–±–∏—Ç/—Å',~ 0j5": 1000*bandwidth=. inputs C durations
    print ' –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É —Å –ø–æ–º–µ—Ö–∞–º–∏, I(Z,Y): ',' –ö–±–∏—Ç/—Å',~ 0j5": 1000*speed_fault=. outputs (information)IZY durations
    print ' –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Å –ø–æ–º–µ—Ö–∞–º–∏, –°'': ',' –ö–±–∏—Ç/—Å',~ 0j5": 1000*bandwidth_fault=. outputs (conditional)C_faulty durations
    speed, bandwidth, speed_fault, bandwidth_fault
)

NB. –ó–∞–ø—É—Å–∫–∞–µ—Ç –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –≤—ã—á–∏—Å–ª—è–µ—Ç –º–∏–Ω–∏–º—É–º –∏ —Å—Ä–µ–¥–Ω–µ–µ
'minimum maximum average'=: (<./ ; >./ ; trials %~ +/) trial"0] 1 + i. trials
'avg_speed avg_bandwidth avg_speed_fault avg_bandwidth_fault'=: 1000*average

print '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ'
print '–°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É –±–µ–∑ –ø–æ–º–µ—Ö, I(Y): ',' –ö–±–∏—Ç/—Å',~ 0j5": avg_speed
print '–°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –±–µ–∑ –ø–æ–º–µ—Ö, –°: ',' –ö–±–∏—Ç/—Å',~ 0j5": avg_bandwidth
print '–°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–º—É –∫–∞–Ω–∞–ª—É —Å –ø–æ–º–µ—Ö–∞–º–∏, I(Z,Y): ',' –ö–±–∏—Ç/—Å',~ 0j5": avg_speed_fault
print '–°—Ä–µ–¥–Ω—è—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Å –ø–æ–º–µ—Ö–∞–º–∏, –°'': ',' –ö–±–∏—Ç/—Å',~ 0j5": avg_bandwidth_fault
